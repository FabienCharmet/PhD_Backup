\section{First approach: Game Theory}

We investigate the resource allocation problem previously described with the formalism of Game Theory.
We consider a two player game, where one player will be the attacker and will compromise the infrastructure to gain access to confidential data. The other player will be the the infrastructure owner and will be referred to as ''the defender`` for the rest of this chapter.
We will present the assumptions made, the players, their strategies and the different types of games considered.

\subsection{Objectives of the game}
Regardless of the type of game considered, we investigated the formalism with the following idea in mind: "Can we minimize the burden of monitoring by using alternative strategies like decoys or Moving Target Defense ?".
The solution of the game is supposed to show whether or not the defender can benefit from these techniques. Precisely, we consider that setting up a decoy in the infrastructure is lest costly than permanently monitoring the infrastructure. We want to determine if using a cheap alternative defense technique is more efficient than using a costly monitoring solution.
In a similar way, we want to determine if the attacker should do an extensive information collection phase prior to actually attacking the infrastructure, or if the use of decoys is not going to be an effective method to prevent the attacker from attacking blindly.



\subsection{Assumptions}
We have made several assumptions about the scope of the game:\\
\textbf{Migration: } The migration has already started when the game starts.\\
\textbf{Constrained budgets: } Both players have limited capacities to either attack or defend the infrastructure.
This implies that the whole infrastructure cannot be attacked or defended.\\
\textbf{Complete information: } The game is considered to be of complete information.\\


\subsection{Defender}
The goal of the defender is to protect his infrastructure by either deploying monitoring or decoy on nodes. A decoy node contains flow rules that will mislead the attacker into believing the node is part of the new embedding of the migrated network.

The defender can choose among three different strategies:\\
\textbf{Installing a decoy: } The defender installs flow rules in a node that will hold information related to the migrated network but the node will in fact not be used to embed the virtual network.\\
\textbf{Monitoring a node: } The defender deploys monitoring on the node to contribute to the detection.\\
\textbf{Doing nothing}

\subsection{Attacker}
The attacker will compromise the migration to gain access to his victim's sensitive data.
The attack is done by installing flow rules in specific nodes that will allow him to duplicate the victim's traffic towards one of his virtual machines, as depicted in Fig.~\ref{fig:data-exfiltration-attack}. 
The attacker will compromise several nodes in order to establish a path between his victim's VN and one of his VMs.
He will then use the compromised nodes to duplicate the victim's network traffic and redirect it towards his VM.
The attack is considered complete when all the nodes establishing the full unauthorized path have been compromised.

\textbf{Location: } The attacker has compromised one node in the infrastructure.\\
\textbf{Attacker's resources: } The attacker owns virtual machines in the infrastructure.\\
\textbf{Attacker's capacities: } The attacker can scan or attack any node in the infrastructure.\\
\textbf{Attacker's victim knowledge: } The attacker can identify the flow rules belonging to his victim.\\
\textbf{Attacker's infrastructure knowledge: } The attacker has the view of the whole physical infrastructure.\\
\textbf{Attacker's embedding knowledge: } The attacker does not know the new embedding for his victim's virtual network.


The attacker can choose among three different strategies:\\
\textbf{Scanning a node: } The attacker can request the list of  flow rules installed in a node. This allows him to discover the embedding location of his victim.\\
\textbf{Attacking a node: } The attacker will install in a node specific rules to construct the path between his VM and the victim's virtual network.\\
\textbf{Doing nothing}\\



\subsection{Games considered to solve the RA problem}
We have considered several types of games for this problem, and we will present their limitations and impact.

\textbf{Static games:} These games are played on each node of the infrastructure, only once. We investigated a game based on the works of Ismail~\etal~\cite{Chen2009,interdep-ismail2017}. The immediate limitation of this game is the inadequacy to use scans and decoys as the attacker is supposed to leverage the information collected to improve his next attack. This leaves us with a model where the attacker either attacks a node or not, and similarly the defender does the same.

The second limitation of static games is their inadequacy to represent the migration process as a succession of steps, where the system would become more and more worth attacking because the number of nodes holding valuable information would increase as the migration goes on.

% The work of Ismail~\etal takes the Game Theory formalism far in the modeling, and focuses on several aspects of an infrastructure running on a legacy network. The opportunity here is to add the representation of SDN and the decoupling of the control plane and the data plane in the model.

The previous limitations convinced us that static games were not a fruitful lead to investigate.
We draw the same conclusion for repeated games, as these are static games repeated several times without any change in the way the game is played.

% \textbf{Repeated games: } These games are static games played several times.
% Since the game must remain unchanged at every play, the limitations encountered woth static games still apply here. 

\textbf{Sequential games: } These games represent players taking turns choosing their action. This aspect makes them more interesting to consider than static games, because the migration process can be represented along the choices made by players. In this situation, the complete information aspect of the game can still be maintained, but the idea of using decoys in the infrastructure requires an imperfect information game. The location of decoys must remain unknown to the attacker to be effective.
Indeed, if the attacker knows where the decoys are deployed he will not attack these nodes.

The main limitation encountered here is that the choice of all players must be revealed after every player has chosen his strategy. Therefore, it is impossible to accumulate rounds without revealing the defender's actions to the attacker. This makes the use of decoys worthless and limit us again to a simple attack/defend/do nothing scheme, similarly to static games.

\textbf{Stochastic games:} Modeling the evolution of a system based on the choices made by players is an interesting formalism for our problem. We can consider the evolution of the infrastructure as the migration process goes on, as well as the progress of the attacker to exfiltrate the data. 

The costs of the strategies are different for the attacker and the defender, thus making the game a non zero-sum stochastic game. Non zero sum stochastic games with imperfect information turn out to be widely complex to solve, and to the best of our knowledge there is no algorithm that can be used as a support for the resolution for a network security problem. 

Additionally, considering a zero-sum stochastic game would make the computation of the equilibrium tractable but at the expense of the game's realism.
We prefer to consider the formalism of Markov Decision Processes (MDP), which have a similar nature to stochastic games. MDPs are more flexible because a single agent is interacting with the system, and the perfect information aspect of game theory is not relevant in this context. 


\subsection{Discussion}
We have reviewed several types of games in this section, where each type has its own share of limitations regarding our problem. Another aspect that we have not detailed before is the acceptable granularity of actions for the players. Indeed, the vast majority of work we have surveyed in Chapter~\ref{sec:sota} limit the players to a binary choice: attacking/defending or doing nothing. This reduced number of choices leaves us with the interrogation of whether we are allowed to define precise strategies for a security game, or if each strategy must be significantly different from every other~\cite{Kiennert2018}. 
This also raises the question of the validity of the complete information hypothesis.
This assumption is common in network security games, which may not be realistic in practical scenarios.
While an attacker will expect monitoring counter-measures in the infrastructure, it is not trivial to assume that the attacker knows about the specificity of the counter-measures deployed in the infrastructure, especially if their nature deviate from standard IDS solutions (\eg decoys and Moving Target Defense).
% Finally, depending on the type of game chosen, the realism of the modeling is also heavily impacted because of the assumptions made about the system to protect.
% as well as the arbitrary choices made for the costs and rewards.
% In the state of the art, the values chosen in the utility functions rarely are evaluated using a real life methodology, especially on the attacker side where the literature is very scarce. 
This leaves us with the question: "Is the game we have formulated coherent and realistic with current real life use cases ?". 

We conclude this section with the observation that Game Theory does not offer enough flexibility to model our problem. In the next chapter, we explore the use of Markov Decision Processes and illustrate how this formalism can be used to include the consequences of attacks in the strategy of the defender.

\input{figures/exfiltration.tex}

