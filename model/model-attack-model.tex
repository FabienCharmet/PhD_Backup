\input{figures/virtualization-attack-surface.tex}

%\GB{I suggest: ``Attacks against Migration'' as a title}
\label{sec:attacker-model}
The migration of a VN creates virtual nodes and virtual links between them.
Thus, based on  the migration functions we introduced in Section~\ref{sec:migration} and the axioms we have presented in Section~\ref{sec:prop-conf}, we will describe the different components of a threat using the following syntax
%\GB{terms?}
%\FC{The syntax is the combination of terms}
: Attacker - Action - Target.

\subsubsection{Attacker}
We consider the different locations from where an attacker could attack the migration of the VN. 
Figure~\ref{fig:attack-surface} places four different attackers: the insider (A1), the collocated user (A2), the provider (A3), the outsider (A4).

The insider is an attacker located inside the VN that is going to be migrated.
It can be a malicious user able to control a virtual node and deploy incorrect flow rules.
The collocated user is another user of the virtualization platform.
He can use his own topology on the physical infrastructure.
The provider is the owner of the physical infrastructure.
He has access to the SDN switches embedding the virtual topologies.
The outsider is a malicious user outside the SDN environment.
He has limited access to both the VNs and the physical infrastructure.

\subsubsection{Action}
There are 4 major actions that can be performed by an attacker to affect the VNs and their environment.
The first two are related to the infrastructure and the others are related to the data carried across the network.
\begin{itemize}
\item Unauthorized access to a network element.
\\ This type of access represent a violation of each security property.
\item Disruption of service on a network element.
\\ The availability of physical and virtual resources becomes compromised
\item Information disclosure without authorization.
\\ The confidentiality of the data is affected
\item Information modification or destruction without authorization.
\\ The integrity of the data or the network resource is affected
\end{itemize}

\subsubsection{Target}
We can consider two types of targets: nodes or data.
The nodes are either the physical switches in the infrastructure or the virtual nodes of a VN.
There are three types of data inside a VN and its infrastructure.
The user data carried by the virtual elements, the management data and the configuration data carried by the infrastructure. 

The user data is the traffic generated by the user and going through the VN.
The management data is made of the different packets exchanged between the virtualization layer and the physical infrastructure to operate properly (capacities, established links, etc.).
The configuration data are the different flow rules deployed on the physical switches when instantiating a VN.
It is important to note that both configuration data and management data are issued by the hypervisor but do not serve the same purpose nor have the same frequency of use, even though they use the same communication channel.
Management data are regularly exchanged between the hypervisor and the switch to maintain the view of the infrastructure (\eg symmetric messages like HELLO requests), while configuration data are sent when installing new flow rules or removing old ones (asynchronous messages sent because of flow expiration).

\begin{table}[h]
\centering
\begin{tabular}{|l|l|l|}
\hline
\textbf{Attacker}   & \textbf{Action}    & \textbf{Target}             \\ \hline
Insider    & Unauthorized access                  & Nodes              \\ \hline
Collocated & Disruption of service                & User data          \\ \hline
Provider   & Information disclosure               & Management data    \\ \hline
Outsider   & Information modification/destruction & Configuration data \\ \hline
\end{tabular}
\caption{Elements of the attack model}
\label{tab:attack-model}
\end{table}

\subsubsection{Attacks}
\label{sec:model-attacks}
%\GB{please in this section and the following, specify which attack is directed against which algorithm}
In the previous sections, we have defined the different attackers, as well as the malevolent actions and possible targets in the virtualization infrastructure. 
Table~\ref{tab:attack-model} summarizes these information.
We will combine elements from each column together to define several attacks targeting the migration process or the user's data.
These attacks are based on two assumptions: a stable initial environment and no outsider attacker.
We consider that the virtualization infrastructure is not already under attack when a malicious user decides to launch one of the following attacks.
This assumption comes from the fact that we aim to detect the switch between a safe state and a compromised state. From a practical point of view, the infrastructure runs most of the time with a normal behavior.
We also assume that an attacker residing outside the virtualization infrastructure and not using the virtualization service has little to no attack surface on the infrastructure.
Most interfaces to interact with any component of the system are limited in visibility from the outside world.
For instance, the DPAC provides an interface for end users to interact with their virtual network, and there is no openly identified weaknesses for an outsider to use (\ie the hypervisor will reject commands from unauthorized users).
Similarly, the CPAC provides an interface between the hypervisor and the physical nodes, and there is no functional use for this component to be interfaced with the outside world.
We summarize the attacks in Table~\ref{tab:use-case-attack}.

% Please add the following required packages to your document preamble:
% \usepackage{graphicx}
\begin{table}[h]
\resizebox{\textwidth}{!}{%
\begin{tabular}{|l|l|l|l|l|}
\hline
Attack                   & Attacker        & Action                      & Target                   & Summary                                                                  \\ \hline
Denial of Service        & Provider side   & Service disruption          & Nodes                    & Resource depletion (DNS amplification ICMP flood) \\ \hline
Info. Disclosure   & Collocated user & Info. disclosure   & Node, user data          & Data exfiltration by malicious flow rules injection    \\ \hline
Config. alteration & Provider side   & Info. modification & Node, config. data & Man-in-the-middle attack to Modify config. data             \\ \hline
Denial of Service        & Provider side   & Service disruption          & Nodes                    & Resource depletion (DNS amplification ICMP flood) \\ \hline
\end{tabular}%
}
\caption{Use cases: Attacking the migration}
\label{tab:use-case-attack}
\end{table}
% In this paper, we chose to focus on the security aspects of the confidentiality.
% Thus, we are more interested in the unauthorized access and information disclosure of the attack model.
% As we also consider a stable initial environment, an outsider attacker is too limited to attack the infrastructure and is therefore of no interest in this paper.
% Finally, the different data present in the threat model are similar enough in essence.
% Attacking one or another makes no difference in terms of formal modeling.
% We propose two different attacks, one focusing on the disclosure of confidential traffic carried by a VN, and the other will be an on-site attack on a physical node.
%\GB{please specify which migration algorithms are attacked here, and in the next section}

%\GB{in general, you could sum up in a table what attacker can do what against what. I am surprised that you only have two scenarios. Usually attacker classes tend to be ordered sets. But it is not always the case}
%\FC{I believe one attack scenario per migration algorithm is enough. However I agree with the table, will work on it today. I don't understand what you mean by ordered sets.}
%\GB{usually, you describe different attackers that share abilities, from the least potent to the most potent. Usually the least potent has ability to perform action A, then the second least potent can do actions A and B, then another can do actions A, C and D, and the most potent can do A, B, C and D. If you are presenting only a couple of scenarios, you may actually list all possible scenarios, \ie triplets (Attacker, Action, Target) and explicitly state that you will only demonstrate two of them, motivating why you choose these}




\paragraph{Denial of Service}\textbf{\\}
In this scenario, the attacker is located inside the physical infrastructure, and will launch Denial of Service (DoS) attacks to render one or several nodes unavailable.
This will result in a forced migration, thus creating an opportunity to compromise the migration process.
This attack becomes the necessary first step of all of the following attacks.

\subparagraph{Hypotheses}\textbf{\\}
% \textbf{Location:} The attacker is located either inside the physical infrastructure or is a malicious user of the virtualization service.\\
\textbf{Information gathering}\textbf{\\}
THe attacker has collected information about his victim, and how to precisely target network equipments.
The information collection process is considered out of scope of this work.\\
\textbf{Traffic generation:} The attacker can generate enough traffic to cause a service disruption.
DoS attacks like ICMP flood or DNS amplification are used for to deplete network resources in the infrastructure.

\subparagraph{Attack methodology}\textbf{\\}
The attacker will generate massive amounts of traffic to generate congestion effects inside the network. The attacker may be located inside the physical network, or he may be the owner of a Virtual Network. The second option is easier to achieve but the attacker will be confronted to the resource isolation enforced by the hypervisor (\ie FlowVisor bandwidth isolation mechanism)


\subparagraph{Impacts}\textbf{\\}
This attack impacts the following security properties:\\
The \textbf{availability} of nodes in the infrastructure has been impacted because of the DoS attack.
% \begin{itemize}
%     \item $node\_availability(N)$
%     \item $vnode\_availability(n)$
%     \item $vlink\_availability(l)$
%     \item $path\_availability(P)$
%     \item $vpath\_availability(P)$
% \end{itemize}

\paragraph{Information disclosure}\textbf{\\}
In this scenario, the attacker is a collocated user that is gaining access to another user's confidential traffic. 
\subparagraph{Hypotheses:}\textbf{\\}
\textbf{Collocated attacker:} The attacker owns a virtual network in the infrastructure.\\
\textbf{Migration trigger:} The attacker can trigger the migration of the victim's VN.\\
\textbf{Embedding knowledge:} The attacker has approximate knowledge of the new substrate network.\\
\textbf{Writing rights:} The attacker can install specific flow rules inside a node.

\subparagraph{Attack methodology:}\textbf{\\}
In order to gain access to confidential data, the attacker generates instability in the infrastructure. Typically, generating lots of requests between nodes and users will create enough disruption to force the migration.
Then, he will use his knowledge of the embedding of the virtual network to target specific nodes.
Deploying probes in the network or attacking on a large scale the infrastructure could lead the virtualization layer to a particular deployment. Co-residency-based attacks and vulnerabilities are exploited in several cases~\cite{malicious-atya2017,nomad-Moon2015b,getoffmucloud-Ristenpart2009,stalling-atya2017}.
An attacker uses time-based attacks to verify the co-residency with his victim and then the attacker will compromise the confidential data by redirecting it from the victim's VN toward a malicious end host belonging to him.
Such attacks rely on deploying specific flow rules on a set of physical nodes that will copy the confidential traffic and route it towards the attacker.
This methodology is illustrated in~\cite{Costa2015,Sphinx-Dhawan2015}.


\subparagraph{Impacts}\textbf{\\}
This attack impacts the following security properties:\\
The \textbf{availability} of specific nodes in the infrastructure has been impacted to force the migration.
% \begin{itemize}
%     \item $node\_availability(N)$
%     \item $vnode\_availability(n)$
%     \item $vlink\_availability(l)$
%     \item $path\_availability(P)$
%     \item $vpath\_availability(P)$
% \end{itemize}
The \textbf{confidentiality} of the data that has been extracted by the attacker.
% \begin{itemize}
%     \item $confidentiality(D)$
% \end{itemize}
The confidentiality of the nodes is not impacted because the attacker did not access the node by installing flow rules on them, with respect to the definition provided in the previous section.\\
The \textbf{integrity} of the different nodes that have been used to forward the data to the attacker.
%     \begin{itemize}
%     \item $node\_integrity(N)$
%     \item $vnode\_integrity(n)$
%     \item $vlink\_integrity(l)$
% \end{itemize}
The \textbf{co-residency} between both victim and attacker VNs has been increased for the attacker to successfully exfiltrate the victim's data.


\paragraph{Migration alteration}\textbf{\\}
We now consider a malicious user intending to exploit the migration process to modify the configuration deployed on a node.

\subparagraph{Hypotheses:}\textbf{\\}
\textbf{Provider side attacker:} The attacker sits between the node and the hypervisor.\\
\textbf{Man-in-the-middle:} The attacker can modify the configuration information sent by the hypervisor in a specific node.\\
\textbf{Migration trigger:} The attacker can trigger the migration of the victim's VN.\\
\textbf{Embedding knowledge:} The attacker has approximate knowledge of the new substrate network.

\subparagraph{Attack methodology:}\textbf{\\}
First of all, the attacker gains access to a networking equipment between the target node and the hypervisor. Similarly to the previous attack, this is done by exploiting vulnerabilities in the physical equipments.
Then, he will trigger the migration of a specific physical node, that will be redeployed on the node targeted by the Man-in-the-middle attack.
Once the hypervisor sends the different flow rules, the attacker will modify them to fit his extraction scheme.

\subparagraph{Impacts:}\textbf{\\}
This attack impacts the following security properties:\\
The \textbf{availability} of the attacked node has been impacted to trigger the migration.
% \begin{itemize}
%     \item $node\_availability(N)$
%     \item $vnode\_availability(n)$
%     \item $vlink\_availability(l)$
%     \item $path\_availability(P)$
%     \item $vpath\_availability(P)$
% \end{itemize}
The \textbf{confidentiality} of the configuration data that has been modified by the attacker.
% \begin{itemize}
%     \item $config\_confidentiality(conf)$
% \end{itemize}
The confidentiality of the nodes is not impacted for the same reasons described in the previous attack.\\
The \textbf{integrity} of the node and its configuration has been compromised
%     \begin{itemize}
%     \item $node\_integrity(N)$
%     \item $vnode\_integrity(n)$
%     \item $vlink\_integrity(l)$
%     \item $config\_integrity(conf)$
% \end{itemize}

% 
